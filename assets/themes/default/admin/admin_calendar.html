<!-- Main content -->
<section class="content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-4">
        <div class="sticky-top mb-3"> {if $upcoming_events}
          <div class="card card-overflow">
            <div class="card-header">
              <h4 class="card-title">#_upcoming_events#</h4>
            </div>
            <div class="card-body"> 
              <!-- the events -->
        
                 {foreach from=$upcoming_events key=k item=v}
                  
                <div class="external-event " style="background-color:{if $v.color}{$v.color}{else}#3c8dbc{/if}">
                <a href="admin.php?do=calendar&event={$v.event_id}" class="text-white"> {if $v.name}{$v.name}:{/if} {$v.event_title}</a></div>

                {/foreach}
         
            </div>
            <!-- /.card-body --> 
          </div>
          {/if}
          <form method="post" id="dataForm34" action="admin.php?do=calendar&job=create">
            <input name="color" id="event_color" type="hidden" value="#3c8dbc" >
            
            <!-- /.card -->
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">#_create_event#</h3>
              </div>
              <div class="card-body">
                <div class="btn-group" style="width: 100%; margin-bottom: 10px;">
                  <ul class="fc-color-picker" id="color-chooser">
                    <li><a class="text-primary" href="#"><i class="fas fa-square"></i></a></li>
                    <li><a class="text-warning" href="#"><i class="fas fa-square"></i></a></li>
                    <li><a class="text-success" href="#"><i class="fas fa-square"></i></a></li>
                    <li><a class="text-danger" href="#"><i class="fas fa-square"></i></a></li>
                    <li><a class="text-info" href="#"><i class="fas fa-square"></i></a></li>
                  </ul>
                </div>
                <div class="form-group"> 
                  <!-- /btn-group -->
                  <div class="input-group">
                    <input name="event_time" id="timepicker-val" type="text" class="form-control" placeholder="#_event_time#" readonly="true">
                    <div class="input-group-append">
                      <button id="timepicker" type="button" class="btn btn-info"><i class="far fa-calendar-times"></i> #_event_set_time#</button>
                    </div>
                    <!-- /btn-group --> 
                  </div>
                </div>
                <div class="form-group">
                  <select size="1" name="event_user" class="form-control">
                    
          {$admins}
					
        
                  </select>
                </div>
                <div class="form-group">
                  <input name="event_title" type="text" class="form-control" placeholder="#_event_title#" >
                </div>
                <div class="form-group">
                  <textarea rows="2" name="event_desc"  class="form-control required mceEditor" id="msg_edit" placeholder="Event description"></textarea>
                </div>
                <div class="form-group">
                  <input name="event_url" id="new-event" type="text" class="form-control" placeholder="#_event_url#" >
                </div>
                <div class="form-group">
                  <button type="submit" class="btn btn-primary btn-block" id="add-new-event"><i class="far fa-save"></i> #_button_save#</button>
                </div>
                
                <!-- /input-group --> 
              </div>
            </div>
          </form>
        </div>
      </div>
      <!-- /.col -->
      <div class="col-md-8">
        <div class="card card-primary">
          <div class="card-body p-0"> 
            <!-- THE CALENDAR -->
            <div id="calendar"></div>
          </div>
          <!-- /.card-body --> 
        </div>
        <!-- /.card --> 
      </div>
      <!-- /.col --> 
    </div>
    <!-- /.row --> 
  </div>
  <!-- /.container-fluid --> 
</section>
<!-- /.content --> 

<!-- TinyMCE -->{$TinyMCE_Config} 
<!-- /TinyMCE --> 

<script>
  $(function () {
    var Calendar = FullCalendar.Calendar;
    var calendarEl = document.getElementById('calendar');

    var calendar = new Calendar(calendarEl, {
      headerToolbar: {
        left  : 'prev,next today',
        center: 'title',
        right : 'dayGridMonth,timeGridWeek,timeGridDay'
      },
      events: 'admin.php?do=calendar&job=calender_events',  
      editable  : false,
      droppable : false, // this allows things to be dropped onto the calendar !!!

    });

    calendar.render();
   

    /* ADDING EVENTS */
    var currColor = '#3c8dbc' ;
    $('#color-chooser > li > a').click(function (e) {
      e.preventDefault()
      // Save color
      currColor = $(this).css('color');
      $('#event_color').val(currColor);   
      $('#add-new-event').css({
        'background-color': currColor,
        'border-color'    : currColor
      })
    })

  })
    
    
    $(document).ready(function () {
    $('#timepicker').daterangepicker({
        singleDatePicker: true,
        timePicker24Hour: true,
        showDropdowns: true,
        minYear: parseInt(moment().year()),
        timePicker: true,
        startDate: moment().startOf('hour'),
        maxYear: parseInt(moment().year() + 3)
      },
      function (start, end) {
        $('#timepicker-val').val(start.format('DD/MM/YYYY hh:mm'));
      }
    );

        
        
});
    

    
    
</script> 